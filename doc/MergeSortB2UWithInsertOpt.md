#### 自底向上的归并排序使用插入排序进行优化

对于小规模的数组，使用插入排序法更快。对于自顶向下的归并排序，当数组分割到足够小，便可以使用插入排序，如下代码所示：

```java
//优化2，如果数组长度小于某个阈值，就采用插入排序，性能更佳
if (r - l <= 15) {
        InsertionSort.sort(arr, l, r);
        return;
    }
```



但对于自底向上的归并排序，一开始处理的就是小数组(元素个数为1、2、4、8...)，所以，我们一开始就需要使用插入排序算法，先把小规模的数组进行排序，如下代码所示：

```java
    // 遍历一遍，对所有 arr[i, i + 15] 的区间，使用插入排序法
    // 注意 i 每次加 16
    for(int i = 0; i < n; i += 16){
        InsertionSort.sort(arr, i, Math.min(i + 15, n - 1));
    }
    //再进行归并操作，size不是1了，而是16
```

这样一来，原数组就分割成了若干个**长度不超过16的有序数组**。所以size的起点自然也就不是1了，而是16。

